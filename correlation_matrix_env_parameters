#-------------------------------- Correlation matrices for the environmental parameters --------------------------------------# 
# I first of all took Pablo's dataset with the chemistry and fish data and created a new Excel file, in which I only put
# the data of the environmental parameters that we are interested in: TP, Chl a, DOC, Temperature, PAR I, TN

library("readxl")
data_tp <- read_excel("/Users/berenikebick/Documents/Uni Master/SoSe20/Masterarbeit/Experiment_Data/environmental_parameters.xlsx")

head(data_tp)  

# set all factors as factors and all numeric variables as numeric

data_tp$Experiment <- as.factor(data_tp$Experiment)

data_tp$Lake <- as.factor(data_tp$Lake)

data_tp$TP <- as.numeric(data_tp$TP)

data_tp$Chla <- as.numeric(data_tp$Chla)

data_tp$DOC <- as.numeric(data_tp$DOC)

data_tp$Temperature <- as.numeric(data_tp$Temperature)

data_tp$PAR_I <- as.numeric(data_tp$PAR_I)

data_tp$TN <- as.numeric(data_tp$TN)

# 1. correlation matrix which shows p-values

library(psych)

pairs.panels(data_tp[,-c(1:2)],         # exclude columns 1 & 2 (Lakes and Experiment)
             method = "pearson",        # correlation method
             hist.col = "#00AFBB",
             density = TRUE,            # show density plots
             ellipses = TRUE            # show correlation ellipses
)

# 2. correlation matrix which shows different colours for the lakes 

library("graphics")

pairs(data_tp[,-c(1:2)], pch = 19,  cex = 0.5,
      col = data_tp$Lake, 
      lower.panel=NULL, oma = c(2, 2, 2, 2), cex.labels = 2)
par(xpd = NA)
legend("bottomleft",fill = unique(data_tp$Lake),legend= c(levels(data_tp$Lake)), cex = 1)


